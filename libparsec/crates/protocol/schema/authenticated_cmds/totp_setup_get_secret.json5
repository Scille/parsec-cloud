[
    {
        "major_versions": [
            5
        ],
        "cmd": "totp_setup_get_secret",
        "req": {
            "fields": []
        },
        "reps": [
            {
                "status": "ok",
                "fields": [
                    // TOTP configuration according to RFC 6238.
                    // Only the secret is provided since we use the defaults
                    // values for the rest (i.e. SHA1, 30s period, 6 digits).
                    // see https://datatracker.ietf.org/doc/html/rfc6238
                    {
                        // TOTP secret to configure in the user's authenticator app.
                        "name": "totp_secret",
                        "type": "Bytes"
                    }
                ]
            },
            {
                // The TOTP has already been setup.
                // Note if the end user no longer has access to the TOTP secret (e.g.
                // he has lost his phone containing his authenticator app), then
                // he should contact a server admin that can then do a TOTP reset so
                // that `totp_setup_get_secret` can be called again.
                "status": "already_setup"
            }
        ]
    }
]
